# UVM Practice 23: Ассемблер и интерпретатор для учебной виртуальной машины

---

## Общее описание

Данный проект представляет собой ассемблер и интерпретатор для **учебной виртуальной машины (УВМ)**, разработанный в рамках практической работы по дисциплине "Конфигурационное управление".  
Проект выполнен на языке **Python** и состоит из нескольких этапов:

1. **Ассемблер** — преобразует текстовое представление команд в промежуточное и машинное представление.
2. **Интерпретатор** — выполняет программы, сгенерированные ассемблером, используя модель памяти УВМ.
3. **Тестирование** — включает примеры программ и тестовые сценарии для проверки корректности работы.

**Вариант задания:** №23

---

## Описание всех функций и настроек

### Структура проекта

**uvm-practice-23/**
- **src/**
  - assembler.py
  - interpreter.py
  - uvm.py
  - utils.py
- **examples/** (папка с примерами)
- **tests/** (папка с тестами)
- README.md
- requirements.txt

---

### Спецификация УВМ (вариант 23)

Виртуальная машина поддерживает 4 команды:

| Команда            | Код (A) | Размер | Операнд                                  | Результат                                |
|--------------------|---------|--------|------------------------------------------|------------------------------------------|
| Загрузка константы | 14      | 2 байт | Поле B (9 бит)                           | Новый элемент на стеке                   |
| Чтение из памяти   | 38      | 1 байт | Адрес из вершины стека                   | Новый элемент на стеке                   |
| Запись в память    | 27      | 1 байт | Элемент с вершины стека                  | Значение в памяти по адресу из стека     |
| Сравнение "<="     | 12      | 1 байт | Два элемента с вершины стека             | Результат сравнения на стеке             |

**Тестовые байтовые последовательности:**

- `14, 73` → `0x4E, 0x12`
- `38` → `0x26`
- `27` → `0x1B`
- `12` → `0x0C`

### Язык ассемблера (формат YAML)

Каждая команда описывается в YAML-формате:

```yaml
- opcode: 14
  B: 73

- opcode: 38

- opcode: 27

- opcode: 12

```
---

## Описание команд для сборки проекта и запуска тестов

### 1. Установка зависимостей
Убедитесь, что у вас установлен **Python 3.8+**. Затем установите зависимости:

```bash
pip install -r requirements.txt
```
### 2. Сборка проекта

```bash
python src/assembler.py -i examples/program.yaml -o program.bin

```
**Параметры:**
- `-i` — путь к исходному YAML-файлу

- `-o` — путь к выходному бинарному файлу

### 3. Запуск интерпретатора

```bash
python src/interpreter.py -i program.bin -d memory_dump.csv -r 0:100

```

Параметры:

-i — путь к бинарному файлу программы

-d — путь к файлу дампа памяти (CSV)

-r — диапазон адресов для дампа (например, 0:100)

### 4. Запуск тестов

```bash
python -m pytest tests/ -v

```
---

## Примеры использования

### Пример 1: Загрузка константы и запись в память
**Исходный файл (`example1.yaml`):**
```yaml
- opcode: 14
  B: 73

- opcode: 27

```
Сборка и выполнение:
```bash
python src/assembler.py -i example1.yaml -o example1.bin
python src/interpreter.py -i example1.bin -d dump1.csv -r 0:10
```

### Пример 2: Чтение из памяти и сравнение
Исходный файл (example2.yaml):
```yaml
- opcode: 38

- opcode: 12
```
Сборка и выполнение:
```bash
python src/assembler.py -i example2.yaml -o example2.bin
python src/interpreter.py -i example2.bin -d dump2.csv -r 0:10
```

### Пример 3: Тестовая программа из задания
Программа выполняет поэлементную операцию "<=" над вектором длины 7 и числом 233, результат записывается в исходный вектор.
Исходный файл (vector_test.yaml):
```yaml
# Загрузка чисел в память
- opcode: 14
  B: 233

- opcode: 27

# Чтение и сравнение элементов
- opcode: 38

- opcode: 14
  B: 100

- opcode: 12

# Сохранение результата
- opcode: 27
```
Сборка и запуск:
```bash
python src/assembler.py -i tests/vector_test.yaml -o vector_test.bin
python src/interpreter.py -i vector_test.bin -d vector_dump.csv -r 0:50
```